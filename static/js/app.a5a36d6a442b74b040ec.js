webpackJsonp([1],{42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a,o,i=n(3),l=n.n(i),c=n(44),u=n.n(c),s=n(54),d=n.n(s),f=n(33),h=n.n(f),v=n(34),m=n.n(v),y=n(35),p=n.n(y),k=n(36),E=n.n(k),b=n(39),g=n.n(b),P=n(89),R=n.n(P),C=n(94),w=n(40),x=function(e){var t=e.chessman,n=e.isLast,r=0===t?"black":"white";return l.a.createElement("div",{className:C[r]+" "+C.chessman},n&&"+")},L=function(e){var t=e.cell,n=e.pos,r=e.play,a=e.lastPos,o=function(){null===t&&r(n)},i=Object(w.List)(n).equals(Object(w.List)(a));return l.a.createElement("div",{className:C.cell,onClick:o},null!==t&&l.a.createElement(x,{chessman:t,isLast:i}))},_=function(e){var t=e.row,n=e.rowIndex;return l.a.createElement("div",{className:C.row},t.map(function(t,r){return l.a.createElement(L,R()({key:r,pos:[n,r],cell:t},e))}))},S=function(e){var t=e.data;return l.a.createElement("div",{className:C.board},t.map(function(t,n){return l.a.createElement(_,R()({key:n,row:t,rowIndex:n},e))}))},W=S,M=n(41),j=n.n(M),A=n(97),B=n.n(A),O=function(e){function t(){var e,n,r,a;m()(this,t);for(var o=arguments.length,i=Array(o),l=0;l<o;l++)i[l]=arguments[l];return n=r=E()(this,(e=t.__proto__||h()(t)).call.apply(e,[this].concat(i))),r.state={cvs:null,ctx:null},r.drawBoard=function(){var e=document.querySelector("#board"),t=e.getContext("2d");t.beginPath();for(var n=1;n<=10;n++)t.moveTo(0,16*n+15*(n-1)),t.lineTo(310,16*n+15*(n-1)),t.moveTo(16*n+15*(n-1),0),t.lineTo(16*n+15*(n-1),310);t.stroke()},r.drawChessman=function(){var e=r.props,t=e.pos,n=e.currentRound,a=r.state.ctx;if(null!==a){a.clearRect(0,0,310,310);var o=!0,i=!1,l=void 0;try{for(var c,u=j()(t.entries());!(o=(c=u.next()).done);o=!0){var s=c.value,d=B()(s,2),f=d[0],h=d[1];if(f>n)break;if(Array.isArray(h)){var v=[31*h[1]+16,31*h[0]+16];a.moveTo.apply(a,v),a.beginPath(),a.arc.apply(a,v.concat([10,0,2*Math.PI])),a.fillStyle=f%2?"#000":"#fff",a.fill(),a.stroke(),f===n&&(a.font="20px Georgia",a.fillStyle="#f00",a.fillText("+",v[0]-6,v[1]+5))}}}catch(e){i=!0,l=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw l}}}},r.handleClick=function(e){var t=r.state.cvs;if(e.target===t){var n=[~~(e.layerY/30),~~(e.layerX/30)];r.props.play(n)}},a=n,E()(r,a)}return g()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.drawBoard();var e=document.querySelector("#chessman"),t=e.getContext("2d");this.setState({cvs:e,ctx:t}),document.addEventListener("click",this.handleClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick)}},{key:"render",value:function(){return this.drawChessman(),l.a.createElement("div",{style:{position:"relative"}},l.a.createElement("canvas",{id:"board",width:"310",height:"310"}),l.a.createElement("canvas",{id:"chessman",style:{position:"absolute",top:0,left:0},width:"310",height:"310"}))}}]),t}(i.Component),D=(a=r=function(e){function t(){m()(this,t);var e=E()(this,(t.__proto__||h()(t)).call(this));o.call(e);var n=Object(w.List)(Array(10).fill(null)),r=Object(w.List)(Array(10).fill(n));return e.state={initData:w.List.of(r),data:w.List.of(r),currentPlayer:0,currentRound:0,maxRound:0,lastPos:w.List.of(null),hasWinner:!1,version:0},e}return g()(t,e),p()(t,[{key:"componentWillUpdate",value:function(e,t){var n=t.lastPos,r=t.data,a=t.currentRound,o=this.state.currentPlayer;if(!(n.size<=1)&&!0===this.isWin(n.get(a),r.get(a),o)){var i=0===o?"黑方":"白方";this.setState({hasWinner:!0}),alert(i+"胜利！")}}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.currentRound,r=e.lastPos,a=e.currentPlayer,o=e.maxRound,i=e.version;return l.a.createElement("div",null,l.a.createElement("button",{onClick:this.changeVersion},"Switch to ",0===i?"canvas":"DOM"," version"),0===i?l.a.createElement(W,{data:t.get(n),play:this.play,lastPos:r.get(n-o-1)}):l.a.createElement(O,{pos:r,currentRound:n,play:this.play}),l.a.createElement("p",null,"Current player: ",a?"White":"Black"),l.a.createElement("p",null,"Current round: ",n),l.a.createElement("p",null,l.a.createElement("button",{onClick:this.undo,disabled:0===n},"undo"),l.a.createElement("button",{onClick:this.redo,disabled:o<=n},"redo"),l.a.createElement("button",{onClick:this.restart},"restart")))}}]),t}(i.Component),o=function(){var e=this;this.play=function(t){var n=e.state,r=n.data,a=n.currentRound,o=n.currentPlayer,i=n.hasWinner,l=Object(w.List)(r.get(a));if(null===l.get(t[0]).get(t[1])&&!i){var c=l.set(t[0],l.get(t[0]).set(t[1],o));e.setState(function(e){var n=e.currentRound,r=e.data,a=e.lastPos;return{data:r.slice(0,n+1).push(c),currentPlayer:+!e.currentPlayer,currentRound:e.currentRound+1,maxRound:e.currentRound+1,lastPos:a.slice(0,n+1).push(t)}})}},this.undo=function(){e.setState(function(e){return{currentRound:e.currentRound-1,currentPlayer:+!e.currentPlayer,hasWinner:!1}})},this.redo=function(){e.setState(function(e){return{currentRound:e.currentRound+1,currentPlayer:+!e.currentPlayer}})},this.restart=function(){e.setState(function(e){return{currentRound:0,maxRound:0,currentPlayer:0,hasWinner:!1,lastPos:w.List.of(null),data:e.initData}})},this.isWin=function(e,t,n){if(null!==e){return[[[0,1],[0,-1]],[[1,0],[-1,0]],[[1,1],[-1,-1]],[[1,-1],[-1,1]]].some(function(r){return r.reduce(function(r,a){for(var o=0,i=[].concat(d()(e));;){if(i=[i[0]+a[0],i[1]+a[1]],i[0]<0||i[0]>9||i[1]<0||i[1]>9)break;if(t.get(i[0]).get(i[1])!==n)break;o++}return r+o},0)>=4})}},this.changeVersion=function(){e.setState(function(e){return{version:+!e.version}})}},a),I=n(101),N=function(e){u.a.render(l.a.createElement(I.AppContainer,null,l.a.createElement(e,null)),document.getElementById("root"))};N(D)},94:function(e,t){e.exports={board:"Mv6GMBj1v2JyVWEppXakA",row:"_2DMjD28BXR5Eqpt9Bks9y6",cell:"_3VNLvlALC4K1loEPSiSiPU",chessman:"_3d8i8FXIGE7ixFYU7YBfwg",black:"iZkz73gyOMuI8m3NfZgMR",white:"_2_dJhzxa849k2Ccu8Wyq-L"}}},[42]);